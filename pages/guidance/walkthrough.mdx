# Input file walkthrough

Let's go through a simple input file line-by-line. Please clone the lab repository

:::action Download lab resources
```bash
git clone https://github.com/CompDesign/lab-2-resources.git
```
:::

and navigate to the `bulk_Cu` folder and open the `fix_fcc_Cu.in` file:

:::action View LAMMPS input file
```bash
cd bulk_Cu
nano fix_fcc_Cu.in
```
:::

Every LAMMPS input file has the same general sections:

- An *Initialisation* section defining basic properties
- An *Atom Definition* section describing the geometry
- A *Force Fields* section providing the energy model
- A *Run* section for the actual calculations to perform

> These sections are not neccessarily explicit. The information is required and it is a good idea to group locically connected commands, but it is not strictly required.

### Initialisation section

```lammps
# --------------- INITIALIZATION ------------------
clear
units       metal
dimension   3
boundary    p p p
atom_style  atomic
```

1. The first line clears all variables etc. 
2. The second line defines the units to use. There are a few choices available ([see manual](https://lammps.sandia.gov/doc/units.html)) definging convinient units depending on the field. The most important ones are summarized in the table below.
3. This line defines the dimensionality of the problem
4. The fourth line sets periodic boundary conditions in all three directions
5. And the last line in this block sets the atom style (see above)

:::image Unit systems in LAMMPS
| Type       | Mass  | Distance | Energy   | time | temperature | pressure |
| ---------- | ----- | -------- | -------- | ---- | ----------- | -------- |
| `metal`    | g/mol | Angstrom | eV       | ps   | K           | bar      |
| `si`       | kg    | m        | J        | s    | K           | Pa       |
| `electron` | au    | Bohr     | Ha       | fs   | K           | Pa       |
| `real`     | g/mol | Angstrom | Kcal/mol | fs   | K           | atm      |
:::


### Atom definitions

```lammps
# ------------------ ATOM DEFINITION -------------------
lattice   fcc 3.615 orient x 1 0 0 orient y 0 1 0 orient z 0 0 1
region    simbox block 0 1 0 1 0 1

create_box    1 simbox
create_atoms  1 region simbox
```

The next section defines the geometry. LAMMPS has a powerful set of command to define and manipulate geometries. Here we first define a simple fcc lattice with a lattice constaant of 3.615 A. The `orient` arguments allow to align lattice vectors within the cartesian reference frame. This can be useful for advance manipulations.

A lattice defines an infinite and periodic set of lattice points; it doesn't yet introduce atoms into the calculation. To add atoms, we first create a region with id `simbox`. Regions are useful to manipulate parts of the geometry (e.g., both sides of an interface). Here a region that covers the unitcell is defined.

Then we create a simulation box using `create_box` and create atoms at every lattice site in the `simbox` region.

### Force Field

```lammps
# ------------------------ FORCE FIELDS -----------------------
pair_style eam
pair_coeff * * Cu_u3.eam
```

This section defines the energy model and interactions between atoms. The Embedded Atom Method (EAM) is used and parameterised with a potential for Cu given in file `Cu_u3.eam`, located in the same directory. Wildcards were used to asign the same potential to all atoms.

### Other settings

```lammps
#---------------------------Settings----------------------------
compute csym all centro/atom fcc
compute eng all pe/atom 
compute eatoms all reduce sum c_eng
```

It is often useful/informative to define a number of additional settings. In this case, a number of *computes* are defined for properties of interest. There is a very large number of possible computes described in [the manual](https://lammps.sandia.gov/doc/Commands_compute.html). The table explains the computes defined here.

| Compute            | Description                                                                          |
| ------------------ | ------------------------------------------------------------------------------------ |
| `centro/atom`      | Characterise whether an atom is perfectly coordinated or part of a defect or surface |
| `pe/atom`          | Potential Energy per atom                                                            |
| `reduce sum c_eng` | Sum potential energy of all atoms                                                    |

The last compute is a composite; it uses the reduce keyword to sum over all atoms using the compute `eng` defined for each atom. This is useful to calculate sums, avergages or other aggregate global quantities.

### Run section

```lammps
#----------------------Run Minimization-------------------------
reset_timestep 0

thermo 10
thermo_style custom step pe lx ly lz press pxx pyy pzz c_eatoms

dump 1 all custom 400 dump.fix.1.* id type xs ys zs c_csym c_eng 

run 0
undump 1
```

The last section defines the actual calcualtions that are performed.

1. It starts out by reseting the timestep to zero
2. The `thermo` command is used to print thermodynamic information every N (here 10) timesteps. LAMMPS is often used for MD simulations to obtain thermodynamic averages. These traces are useful to calculate these average thermodynamic properties.
3. The `dump` command writes a snapshot of variables into separate files, one for each snapshot.
4. The `run` command starts an MD run for N timesteps (here just one for time-step zero).
5. The `undump` command stops dumping values and closes the files (clean up)
